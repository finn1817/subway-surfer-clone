{"version":3,"file":"index-BKD-4phE.js","sources":["../../site-js/surfer.js"],"sourcesContent":["import kaplay from \"kaplay\";\r\n\r\n// 1. Initialize KAPLAY\r\nkaplay({\r\n    width: 800,\r\n    height: 600,\r\n    background: [135, 206, 235], // Sky blue\r\n    debug: true, // F1 to see hitboxes\r\n});\r\n\r\n// --- CONSTANTS & CONFIG ---\r\nconst LANE_COUNT = 5;\r\nconst LANE_WIDTH = width() / LANE_COUNT;\r\nconst PLAYER_Y = height() - 100;\r\nconst SPEED_START = 400;\r\nconst SPEED_MAX = 1000;\r\nlet currentSpeed = SPEED_START;\r\n\r\n// Calculate the X center of a specific lane\r\nfunction getLaneX(laneIndex) {\r\n    laneIndex = Math.max(0, Math.min(laneIndex, LANE_COUNT - 1));\r\n    return (laneIndex * LANE_WIDTH) + (LANE_WIDTH / 2);\r\n}\r\n\r\n// --- ASSETS ---\r\n// Using loadBean() is safer for now. It loads the default built-in character.\r\n// If you have your file, you can change this back to: loadSprite(\"bean\", \"sprites/bean.png\");\r\nloadBean(); \r\n\r\n// --- SCENE: GAME ---\r\nscene(\"game\", () => {\r\n    \r\n    // VARIABLES\r\n    let currentLane = 2; // Start in middle lane (0-4)\r\n    let score = 0;\r\n    let isJumping = false;\r\n\r\n    // 1. ADD BACKGROUND LINES\r\n    for (let i = 1; i < LANE_COUNT; i++) {\r\n        add([\r\n            rect(2, height()),\r\n            pos(i * LANE_WIDTH, 0),\r\n            color(255, 255, 255),\r\n            opacity(0.3),\r\n            \"lane-marker\"\r\n        ]);\r\n    }\r\n\r\n    // 2. THE PLAYER\r\n    const player = add([\r\n        sprite(\"bean\"),    // Uses the default bean sprite\r\n        pos(getLaneX(currentLane), PLAYER_Y),\r\n        anchor(\"center\"),\r\n        scale(1),\r\n        area(),            // Hitbox\r\n        z(10),             // Draw on top\r\n        \"player\"\r\n    ]);\r\n\r\n    // 3. UI - SCORE\r\n    const scoreLabel = add([\r\n        text(\"Score: 0\"),\r\n        pos(24, 24),\r\n        z(100),\r\n    ]);\r\n\r\n    // --- CONTROLS ---\r\n    \r\n    // Switch Left\r\n    onKeyPress(\"left\", () => {\r\n        if (currentLane > 0) {\r\n            currentLane--;\r\n        }\r\n    });\r\n\r\n    // Switch Right\r\n    onKeyPress(\"right\", () => {\r\n        if (currentLane < LANE_COUNT - 1) {\r\n            currentLane++;\r\n        }\r\n    });\r\n\r\n    // Jump\r\n    onKeyPress(\"space\", () => {\r\n        jumpAction();\r\n    });\r\n\r\n    function jumpAction() {\r\n        if (isJumping) return;\r\n        isJumping = true;\r\n        \r\n        // Visual \"Pop\" effect (Scale Up then Down)\r\n        tween(1, 1.5, 0.2, (val) => player.scale = vec2(val), easings.easeOutQuad)\r\n        .then(() => {\r\n            tween(1.5, 1, 0.2, (val) => player.scale = vec2(val), easings.easeInQuad)\r\n            .then(() => isJumping = false);\r\n        });\r\n    }\r\n\r\n    // --- GAME LOOP ---\r\n\r\n    onUpdate(() => {\r\n        // Smooth movement: Lerp player X to the target lane X\r\n        const targetX = getLaneX(currentLane);\r\n        player.pos.x = lerp(player.pos.x, targetX, dt() * 15);\r\n        \r\n        // Update Score\r\n        score += dt() * 10;\r\n        scoreLabel.text = \"Score: \" + Math.floor(score);\r\n\r\n        // Increase game speed gradually\r\n        if (currentSpeed < SPEED_MAX) {\r\n            currentSpeed += 5 * dt(); \r\n        }\r\n    });\r\n\r\n    // --- OBSTACLE SPAWNER ---\r\n    \r\n    loop(1.0, () => { \r\n        spawnObstacle();\r\n    });\r\n\r\n    function spawnObstacle() {\r\n        // Pick a random lane\r\n        const lane = randi(0, LANE_COUNT);\r\n        \r\n        // 20% chance to spawn a \"Barricade\" (Red) -> Must Jump\r\n        const isBarricade = rand() < 0.2; \r\n\r\n        add([\r\n            rect(LANE_WIDTH - 20, 40), \r\n            pos(getLaneX(lane), -50),\r\n            anchor(\"center\"),\r\n            color(isBarricade ? [255, 0, 0] : [255, 100, 0]), // Red vs Orange\r\n            area(),\r\n            move(DOWN, currentSpeed), // Move down automatically\r\n            offscreen({ destroy: true }), // Cleanup when off screen\r\n            \"obstacle\",\r\n            {\r\n                isBarricade: isBarricade\r\n            }\r\n        ]);\r\n    }\r\n\r\n    // --- COLLISIONS ---\r\n    \r\n    player.onCollide(\"obstacle\", (obs) => {\r\n        // Logic: If it's a barricade AND we are jumping, we are safe\r\n        if (obs.isBarricade && isJumping) {\r\n            shake(2); \r\n        } else {\r\n            // CRASH!\r\n            shake(20);\r\n            go(\"gameover\", Math.floor(score));\r\n        }\r\n    });\r\n});\r\n\r\n// --- SCENE: GAMEOVER ---\r\nscene(\"gameover\", (score) => {\r\n    add([\r\n        text(\"GAME OVER\\nScore: \" + score, { align: \"center\" }),\r\n        pos(center()),\r\n        anchor(\"center\"),\r\n    ]);\r\n\r\n    add([\r\n        text(\"Press Space to Restart\", { size: 24 }),\r\n        pos(center().x, center().y + 100),\r\n        anchor(\"center\"),\r\n    ]);\r\n\r\n    onKeyPress(\"space\", () => go(\"game\"));\r\n});\r\n\r\n// Start the game immediately\r\ngo(\"game\");\r\n"],"names":["kaplay","LANE_COUNT","LANE_WIDTH","PLAYER_Y","SPEED_START","SPEED_MAX","currentSpeed","getLaneX","laneIndex","currentLane","score","isJumping","i","player","scoreLabel","jumpAction","val","targetX","spawnObstacle","lane","isBarricade","obs"],"mappings":"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"}