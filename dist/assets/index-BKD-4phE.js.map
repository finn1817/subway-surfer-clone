{"version":3,"file":"index-BKD-4phE.js","sources":["../../src/main.js"],"sourcesContent":["import kaplay from \"kaplay\";\n\n// 1. Initialize KAPLAY\nkaplay({\n    width: 800,\n    height: 600,\n    background: [135, 206, 235], // Sky blue\n    debug: true, // F1 to see hitboxes\n});\n\n// --- CONSTANTS & CONFIG ---\nconst LANE_COUNT = 5;\nconst LANE_WIDTH = width() / LANE_COUNT;\nconst PLAYER_Y = height() - 100;\nconst SPEED_START = 400;\nconst SPEED_MAX = 1000;\nlet currentSpeed = SPEED_START;\n\n// Calculate the X center of a specific lane\nfunction getLaneX(laneIndex) {\n    laneIndex = Math.max(0, Math.min(laneIndex, LANE_COUNT - 1));\n    return (laneIndex * LANE_WIDTH) + (LANE_WIDTH / 2);\n}\n\n// --- ASSETS ---\n// Using loadBean() is safer for now. It loads the default built-in character.\n// If you have your file, you can change this back to: loadSprite(\"bean\", \"sprites/bean.png\");\nloadBean(); \n\n// --- SCENE: GAME ---\nscene(\"game\", () => {\n    \n    // VARIABLES\n    let currentLane = 2; // Start in middle lane (0-4)\n    let score = 0;\n    let isJumping = false;\n\n    // 1. ADD BACKGROUND LINES\n    for (let i = 1; i < LANE_COUNT; i++) {\n        add([\n            rect(2, height()),\n            pos(i * LANE_WIDTH, 0),\n            color(255, 255, 255),\n            opacity(0.3),\n            \"lane-marker\"\n        ]);\n    }\n\n    // 2. THE PLAYER\n    const player = add([\n        sprite(\"bean\"),    // Uses the default bean sprite\n        pos(getLaneX(currentLane), PLAYER_Y),\n        anchor(\"center\"),\n        scale(1),\n        area(),            // Hitbox\n        z(10),             // Draw on top\n        \"player\"\n    ]);\n\n    // 3. UI - SCORE\n    const scoreLabel = add([\n        text(\"Score: 0\"),\n        pos(24, 24),\n        z(100),\n    ]);\n\n    // --- CONTROLS ---\n    \n    // Switch Left\n    onKeyPress(\"left\", () => {\n        if (currentLane > 0) {\n            currentLane--;\n        }\n    });\n\n    // Switch Right\n    onKeyPress(\"right\", () => {\n        if (currentLane < LANE_COUNT - 1) {\n            currentLane++;\n        }\n    });\n\n    // Jump\n    onKeyPress(\"space\", () => {\n        jumpAction();\n    });\n\n    function jumpAction() {\n        if (isJumping) return;\n        isJumping = true;\n        \n        // Visual \"Pop\" effect (Scale Up then Down)\n        tween(1, 1.5, 0.2, (val) => player.scale = vec2(val), easings.easeOutQuad)\n        .then(() => {\n            tween(1.5, 1, 0.2, (val) => player.scale = vec2(val), easings.easeInQuad)\n            .then(() => isJumping = false);\n        });\n    }\n\n    // --- GAME LOOP ---\n\n    onUpdate(() => {\n        // Smooth movement: Lerp player X to the target lane X\n        const targetX = getLaneX(currentLane);\n        player.pos.x = lerp(player.pos.x, targetX, dt() * 15);\n        \n        // Update Score\n        score += dt() * 10;\n        scoreLabel.text = \"Score: \" + Math.floor(score);\n\n        // Increase game speed gradually\n        if (currentSpeed < SPEED_MAX) {\n            currentSpeed += 5 * dt(); \n        }\n    });\n\n    // --- OBSTACLE SPAWNER ---\n    \n    loop(1.0, () => { \n        spawnObstacle();\n    });\n\n    function spawnObstacle() {\n        // Pick a random lane\n        const lane = randi(0, LANE_COUNT);\n        \n        // 20% chance to spawn a \"Barricade\" (Red) -> Must Jump\n        const isBarricade = rand() < 0.2; \n\n        add([\n            rect(LANE_WIDTH - 20, 40), \n            pos(getLaneX(lane), -50),\n            anchor(\"center\"),\n            color(isBarricade ? [255, 0, 0] : [255, 100, 0]), // Red vs Orange\n            area(),\n            move(DOWN, currentSpeed), // Move down automatically\n            offscreen({ destroy: true }), // Cleanup when off screen\n            \"obstacle\",\n            {\n                isBarricade: isBarricade\n            }\n        ]);\n    }\n\n    // --- COLLISIONS ---\n    \n    player.onCollide(\"obstacle\", (obs) => {\n        // Logic: If it's a barricade AND we are jumping, we are safe\n        if (obs.isBarricade && isJumping) {\n            shake(2); \n        } else {\n            // CRASH!\n            shake(20);\n            go(\"gameover\", Math.floor(score));\n        }\n    });\n});\n\n// --- SCENE: GAMEOVER ---\nscene(\"gameover\", (score) => {\n    add([\n        text(\"GAME OVER\\nScore: \" + score, { align: \"center\" }),\n        pos(center()),\n        anchor(\"center\"),\n    ]);\n\n    add([\n        text(\"Press Space to Restart\", { size: 24 }),\n        pos(center().x, center().y + 100),\n        anchor(\"center\"),\n    ]);\n\n    onKeyPress(\"space\", () => go(\"game\"));\n});\n\n// Start the game immediately\ngo(\"game\");"],"names":["kaplay","LANE_COUNT","LANE_WIDTH","PLAYER_Y","SPEED_START","SPEED_MAX","currentSpeed","getLaneX","laneIndex","currentLane","score","isJumping","i","player","scoreLabel","jumpAction","val","targetX","spawnObstacle","lane","isBarricade","obs"],"mappings":"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"}